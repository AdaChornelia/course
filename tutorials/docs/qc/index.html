<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    <title></title>

    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">


    <link href="../../../css/admonition.css" rel="stylesheet">


    <link href="../../../css/navbar.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            <a class="navbar-brand" href="../../..">Bioinformatics course</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Week 1 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../proteins/">Proteins</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Week 2 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../unix/">Unix</a>
</li>

                        
                            
<li >
    <a href="../../../cloud/">Cloud Computing</a>
</li>

                        
                            
<li >
    <a href="../../../software/">Installing Software</a>
</li>

                        
                            
<li >
    <a href="../../../git/">Git</a>
</li>

                        
                            
<li >
    <a href="../../../blast/">Command-line Blast</a>
</li>

                        
                            
<li >
    <a href="../../../project_organisation/">Project Organisation</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Week 3 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../seq_tech/">Sequencing Technologies</a>
</li>

                        
                            
<li class="active">
    <a href="./">Quality Control</a>
</li>

                        
                            
<li >
    <a href="../mapping/">Mapping and Variant Calling</a>
</li>

                        
                            
<li >
    <a href="../assembly/">De-novo Genome Assembly</a>
</li>

                        
                            
<li >
    <a href="../annotation/">Genome Annotation</a>
</li>

                        
                            
<li >
    <a href="../pan_genome/">Pan-genome Analysis</a>
</li>

                        
                            
<li >
    <a href="../nanopore/">Nanopore Sequencing</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fa fa-search"></i> Search
                        </a>
                    </li>
                    <li >
                        <a rel="next" href="../../../seq_tech/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../mapping/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#quality-control-and-trimming">Quality Control and Trimming</a></li>
            <li class="second-level"><a href="#downloading-the-data">Downloading the data</a></li>
                
            <li class="second-level"><a href="#working-directory">Working Directory</a></li>
                
            <li class="second-level"><a href="#fastqc">FastQC</a></li>
                
            <li class="second-level"><a href="#scythe">Scythe</a></li>
                
            <li class="second-level"><a href="#sickle">Sickle</a></li>
                
            <li class="second-level"><a href="#fastqc-again">FastQC again</a></li>
                
            <li class="second-level"><a href="#multiqc">MultiQC</a></li>
                
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="quality-control-and-trimming">Quality Control and Trimming</h1>
<p>In this practical you will learn to import, view and check the quality of raw high thoughput sequencing sequencing data.</p>
<p>The first dataset you will be working with is from an Illumina MiSeq dataset.
The sequenced organism is an enterohaemorrhagic E. coli (EHEC) of the serotype O157, a potentially fatal gastrointestinal pathogen.
The sequenced bacterium was part of an outbreak investigation in the St. Louis area, USA in 2011.
The sequencing was done as paired-end 2x150bp.</p>
<h2 id="downloading-the-data">Downloading the data</h2>
<p>The raw data were deposited at the European Nucleotide Archive, under the accession number SRR957824.
You could go to the ENA <a href="http://www.ebi.ac.uk/ena">website</a> and search for the run with the accession SRR957824.</p>
<p>However these files contain about 3 million reads and are therefore quite big.
We are only gonna use a subset of the original dataset for this tutorial.</p>
<p>First create a <code>data/</code> directory in your home folder</p>
<pre><code class="bash">mkdir ~/data
</code></pre>

<p>now let's download the subset</p>
<pre><code class="bash">cd ~/data
curl -O -J -L https://osf.io/shqpv/download
curl -O -J -L https://osf.io/9m3ch/download
</code></pre>

<p>Letâ€™s make sure we downloaded all of our data using md5sum.</p>
<pre><code class="bash">md5sum SRR957824_500K_R1.fastq.gz SRR957824_500K_R2.fastq.gz
</code></pre>

<p>you should see this</p>
<pre><code>1e8cf249e3217a5a0bcc0d8a654585fb  SRR957824_500K_R1.fastq.gz
70c726a31f05f856fe942d727613adb7  SRR957824_500K_R2.fastq.gz
</code></pre>

<p>and now look at the file names and their size</p>
<pre><code class="bash">ls -l
</code></pre>

<pre><code>total 97M
-rw-r--r-- 1 hadrien 48M Nov 19 18:44 SRR957824_500K_R1.fastq.gz
-rw-r--r-- 1 hadrien 50M Nov 19 18:53 SRR957824_500K_R2.fastq.gz
</code></pre>

<p>There are 500 000 paired-end reads taken randomly from the original data</p>
<p>One last thing before we get to the quality control: those files are writeable.
By default, UNIX makes things writeable by the file owner.
This poses an issue with creating typos or errors in raw data.
We fix that before going further</p>
<pre><code class="bash">chmod u-w *
</code></pre>

<h2 id="working-directory">Working Directory</h2>
<p>First we make a work directory: a directory where we can play around with a copy of the data without messing with the original</p>
<pre><code class="bash">mkdir ~/work
cd ~/work
</code></pre>

<p>Now we make a link of the data in our working directory</p>
<pre><code class="bash">ln -s ~/data/* .
</code></pre>

<p>The files that we've downloaded are FASTQ files. Take a look at one of them with</p>
<pre><code class="bash">zless SRR957824_500K_R1.fastq.gz
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the spacebar to scroll down, and type â€˜qâ€™ to exit â€˜lessâ€™</p>
</div>
<p>You can read more on the FASTQ format in the <a href="file_formats.md">File Formats</a> lesson.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Where does the filename come from?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Why are there 1 and 2 in the file names?    </p>
</div>
<h2 id="fastqc">FastQC</h2>
<p>To check the quality of the sequence data we will use a tool called FastQC.</p>
<p>FastQC has a graphical interface and can be downloaded and run on a Windows or Linux computer without installation.
It is available <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">here</a>.</p>
<p>However, FastQC is also available as a command line utility on the training server you are using.
To run FastQC on our two files</p>
<pre><code class="bash">fastqc SRR957824_500K_R1.fastq.gz SRR957824_500K_R2.fastq.gz
</code></pre>

<p>and look what FastQC has produced</p>
<pre><code>ls *fastqc*
</code></pre>

<p>For each file, FastQC has produced both a .zip archive containing all the plots, and a html report.</p>
<p>Download and open the html files with your favourite web browser.</p>
<p>Alternatively you can look a these copies of them:</p>
<ul>
<li><a href="../data/fastqc/SRR957824_500K_R1_fastqc.html">SRR957824_500K_R1_fastqc.html</a></li>
<li><a href="../data/fastqc/SRR957824_500K_R2_fastqc.html">SRR957824_500K_R2_fastqc.html</a></li>
</ul>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What should you pay attention to in the FastQC report?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Which file is of better quality?</p>
</div>
<p>Pay special attention to the per base sequence quality and sequence length distribution.
Explanations for the various quality modules can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/">here</a>.
Also, have a look at examples of a <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/good_sequence_short_fastqc.html">good</a> and a <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/bad_sequence_fastqc.html">bad</a> illumina read set for comparison.</p>
<p>You will note that the reads in your uploaded dataset have fairly poor quality (&lt;20) towards the end. There are also outlier reads that have very poor quality for most of the second half of the reads.</p>
<h2 id="scythe">Scythe</h2>
<p>Now we'll do some trimming!</p>
<p>Scythe uses a Naive Bayesian approach to classify contaminant substrings in sequence reads.
It considers quality information, which can make it robust in picking out 3'-end adapters, which often include poor quality bases.</p>
<p>The first thing we need is the adapters to trim off</p>
<pre><code class="bash">curl -O -J -L https://osf.io/v24pt/download
</code></pre>

<p>Now we run scythe on both our read files</p>
<pre><code class="bash">scythe -a adapters.fasta -o SRR957824_adapt_R1.fastq SRR957824_500K_R1.fastq.gz
scythe -a adapters.fasta -o SRR957824_adapt_R2.fastq SRR957824_500K_R2.fastq.gz
</code></pre>

<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What adapters do you use?</p>
</div>
<h2 id="sickle">Sickle</h2>
<p>Most modern sequencing technologies produce reads that have deteriorating quality towards the 3'-end and some towards the 5'-end as well.
Incorrectly called bases in both regions negatively impact assembles, mapping, and downstream bioinformatics analyses.</p>
<p>We will trim each read individually down to the good quality part to keep the bad part from interfering with downstream applications.</p>
<p>To do so, we will use sickle. Sickle is a tool that uses sliding windows along with quality and length thresholds to determine when quality is sufficiently low to trim the 3'-end of reads and also determines when the quality is sufficiently high enough to trim the 5'-end of reads. It will also discard reads based upon a length threshold.</p>
<p>To run sickle</p>
<pre><code class="bash">sickle pe -f SRR957824_adapt_R1.fastq -r SRR957824_adapt_R2.fastq \
    -t sanger -o SRR957824_trimmed_R1.fastq -p SRR957824_trimmed_R2.fastq \
    -s /dev/null -q 25
</code></pre>

<p>which should output something like</p>
<pre><code>PE forward file: SRR957824_trimmed_R1.fastq
PE reverse file: SRR957824_trimmed_R2.fastq

Total input FastQ records: 1000000 (500000 pairs)

FastQ paired records kept: 834570 (417285 pairs)
FastQ single records kept: 13263 (from PE1: 11094, from PE2: 2169)
FastQ paired records discarded: 138904 (69452 pairs)
FastQ single records discarded: 13263 (from PE1: 2169, from PE2: 11094)
</code></pre>

<h2 id="fastqc-again">FastQC again</h2>
<p>Run fastqc again on the filtered reads</p>
<pre><code class="bash">fastqc SRR957824_trimmed_R1.fastq SRR957824_trimmed_R2.fastq
</code></pre>

<p>and look at the reports</p>
<ul>
<li><a href="../data/fastqc/SRR957824_trimmed_R1_fastqc.html">SRR957824_trimmed_R1_fastqc.html</a></li>
<li><a href="../data/fastqc/SRR957824_trimmed_R2_fastqc.html">SRR957824_trimmed_R2_fastqc.html</a></li>
</ul>
<h2 id="multiqc">MultiQC</h2>
<p><a href="http://multiqc.info">MultiQC</a> is a tool that aggreagtes results from several popular QC bioinformatics software into one html report.</p>
<p>Let's run MultiQC in our current directory</p>
<pre><code class="bash">multiqc .
</code></pre>

<p>You can download the report or view it by clickinh on the link below</p>
<ul>
<li><a href="../data/fastqc/multiqc_report.html">multiqc_report.html</a></li>
</ul>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What did the trimming do to the per-base sequence quality, the per sequence quality scores and the sequence length distribution?</p>
</div></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../../..';
    </script>
    <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
    <script src="../../../js/base.js"></script>
    <script src="../../../search/require.js"></script>
    <script src="../../../search/search.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
